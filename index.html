<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Yes to Nails - Service Calculator</title>
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
  <header>
  <h1 class="shimmer-text">Yes to Nails<sup>&reg;</sup></h1>
</header>

<section id="userPanel">
  <div id="logoContainer" class="centered"></div>
  <div id="services" class="service-list-card"></div>
  <div id="cartSection" class="service-list-card">
    <h2>Cart</h2>
    <ul id="cartItems"></ul>
    <p><strong>Total:</strong> AED <span id="cartTotal">0.00</span></p>
    <button class="btn" onclick="clearCart()">Clear</button>
  </div>

  <form id="bookingForm" class="service-list-card">
    <h2>Book Appointment</h2>
    <input type="text" id="name" placeholder="Your Name" required />
    <input type="email" id="email" placeholder="Your Email" required />
    <input type="tel" id="phone" placeholder="Phone Number" required />
    <input type="date" id="bookingDate" required />
    <div id="timeSlots"></div>
    <textarea id="notes" placeholder="Notes (optional)"></textarea>
    <button type="submit" class="btn">Confirm Booking</button>
  </form>
</section>

<section id="adminLoginSection" class="service-list-card">
  <h2>Admin Login</h2>
  <form id="adminLogin">
    <input type="password" id="adminPassword" placeholder="Enter Admin Password" required />
    <button type="submit" class="btn">Login</button>
  </form>
  <p id="adminLoginMessage" class="error"></p>
</section>

<section id="adminPanel" class="hidden">
  <div class="tab-buttons">
    <button onclick="showServiceManager()">Services</button>
    <button onclick="showBookingManager()">Bookings</button>
    <button onclick="showBusinessSettings()">Settings</button>
    <button onclick="logoutAdmin()" class="logout-btn">Logout</button>
  </div>

  <div id="serviceManager" class="tab-section">
    <h2>Manage Services</h2>
    <form id="addServiceForm">
      <input type="text" id="serviceName" placeholder="Name" required />
      <input type="text" id="serviceCategory" placeholder="Category" />
      <input type="number" id="servicePrice" placeholder="Price (AED)" required />
      <input type="number" id="serviceDuration" placeholder="Duration (min)" required />
      <textarea id="serviceDescription" placeholder="Description"></textarea>
      <button type="submit" class="btn">Add Service</button>
    </form>
    <div id="serviceList"></div>
  </div>

  <div id="bookingManager" class="tab-section hidden">
    <h2>Manage Bookings</h2>
    <table>
      <thead>
        <tr>
          <th>Date & Time</th>
          <th>Client</th>
          <th>Services</th>
          <th>Price & Duration</th>
          <th>Status</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="bookingsList"></tbody>
    </table>
  </div>

  <div id="businessSettings" class="tab-section hidden">
    <h2>Business Hours</h2>
    <form id="businessHoursForm">
      <div id="businessHoursFields"></div>
      <button type="submit" class="btn">Save Hours</button>
      <p id="hoursMessage" class="success"></p>
    </form>

    <h2>Logo</h2>
    <input type="file" id="logoUpload" />
    <button class="btn" onclick="saveLogo()">Save Logo</button>
    <div id="logoPreview"></div>

    <h2>Email Settings</h2>
    <label>Email for Admin Notifications</label>
    <input type="email" id="adminEmail" />
    <label><input type="checkbox" id="adminEmailToggle" /> Send Email to Admin</label><br />
    <label><input type="checkbox" id="customerEmailToggle" /> Send Email to Customer</label><br />
    <button class="btn" onclick="saveEmailSettings()">Save Email Settings</button>
    <p id="emailSettingsMessage" class="success"></p>
  </div>
</section>


  <!-- Supabase -->
  <script type="module">
    import { createClient } from 'https://cdn.jsdelivr.net/npm/@supabase/supabase-js/+esm';
    const supabaseUrl = 'https://fyphrauehrmotfderfey.supabase.co';
    const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZ5cGhyYXVlaHJtb3RmZGVyZmV5Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDgyNzcyMjIsImV4cCI6MjA2Mzg1MzIyMn0.OwrKxqDPYPcBl6D4tsfXlKNIcUlwdmCBb1CaAVUy-K0';
    window.supabase = createClient(supabaseUrl, supabaseKey);
  </script>

  <style>
    /* ✅ PASTE YOUR COMPLETE STYLE CSS HERE AS IS — already OK */
  </style>
</head>

<body>
<body>
  <header>
    <div id="logoContainer"></div>
    <h1 class="shimmer-text">Yes to Nails<sup>&reg;</sup></h1>
  </header>

  <nav>
    <a onclick="showUserPanel()">Services</a> |
    <a onclick="showAdminLogin()">Admin</a>
  </nav>

  <!-- === MAIN USER PANEL === -->
  <main id="userPanel">
    <section id="services">
      <h2>Browse Services</h2>
      <select id="categoryFilter" onchange="filterServices()">
        <option value="all">All Categories</option>
      </select>
      <div id="serviceList"></div>
    </section>

    <section id="cartSection">
      <h2>Your Selection</h2>
      <div id="cart"></div>
      <div class="total-section">
        <div class="total-row"><span>Total Duration:</span><span id="totalDuration">0 mins</span></div>
        <div class="total-row"><span>Total Price:</span><span>AED <span id="totalPrice">0.00</span></span></div>
      </div>
    </section>

    <section style="grid-column: span 2;">
      <h2>Book Your Appointment</h2>
      <form id="bookingForm" onsubmit="submitBooking(event)">
        <div class="form-row">
          <div>
            <label for="name">Full Name</label>
            <input id="name" placeholder="Your Name" required type="text" />
          </div>
          <div>
            <label for="email">Email</label>
            <input id="email" placeholder="Your Email" required type="email" />
          </div>
        </div>

        <div class="form-row">
          <div>
            <label for="phone">Phone Number</label>
            <input id="phone" placeholder="Your Phone Number" required type="tel" />
          </div>
          <div>
            <label for="bookingDate">Preferred Date</label>
            <input id="bookingDate" required type="date" onchange="generateTimeSlots()" />
          </div>
        </div>

        <div>
          <label>Select Time Slot</label>
          <div class="time-slots-container" id="timeSlots">
            <p>Please select a date first</p>
          </div>
          <input type="hidden" id="selectedTime" required />
        </div>

        <label for="notes">Special Requests</label>
        <textarea id="notes" placeholder="Any special requests or notes" rows="3"></textarea>

        <button class="btn" id="bookingSubmitBtn" type="submit">Confirm Booking</button>
      </form>
      <div id="confirmation"></div>
    </section>
  </main>

  <!-- === ADMIN LOGIN === -->
  <section id="adminLoginSection" class="hidden">
    <h2>Admin Login</h2>
    <form id="adminLogin" onsubmit="adminAuth(event)">
      <label for="adminUser">Username</label>
      <input id="adminUser" required type="text" placeholder="Admin Username" />
      <label for="adminPass">Password</label>
      <input id="adminPass" required type="password" placeholder="Admin Password" />
      <button type="submit" class="btn">Login</button>
    </form>
    <div id="adminLoginMessage" class="warning-message"></div>
  </section>

  <!-- === ADMIN PANEL === -->
  <section id="adminPanel" class="hidden">
    <h2>Admin Dashboard</h2>
    <div class="logout-link" onclick="logoutAdmin()">Logout</div>

    <div class="tab-container">
      <div class="tab-buttons">
        <button class="tab-button active" onclick="switchTab('servicesTab')">Manage Services</button>
        <button class="tab-button" onclick="switchTab('bookingsTab')">Bookings</button>
        <button class="tab-button" onclick="switchTab('settingsTab')">Settings</button>
      </div>

      <div class="tab-content">
        <!-- SERVICES MANAGER -->
        <div id="servicesTab" class="tab-panel active">
          <div class="admin-card">
            <h3>Service Manager</h3>
            <div id="serviceManagerSection"></div>
          </div>
        </div>

        <!-- BOOKINGS TABLE -->
        <div id="bookingsTab" class="tab-panel">
          <div class="admin-card">
            <h3>Booking List</h3>
            <table class="admin-table">
              <thead>
                <tr>
                  <th>Date/Time</th>
                  <th>Client</th>
                  <th>Services</th>
                  <th>Price</th>
                  <th>Status</th>
                  <th>Action</th>
                </tr>
              </thead>
              <tbody id="bookingsList"></tbody>
            </table>
          </div>
        </div>

        <!-- SETTINGS -->
        <div id="settingsTab" class="tab-panel">
          <div class="admin-card">
            <h3>Business Hours</h3>
            <form id="businessHoursForm"></form>
            <div id="hoursMessage" class="success-message"></div>
          </div>

          <div class="admin-card">
            <h3>Upload Logo</h3>
            <input type="file" id="logoUpload" />
            <button class="btn" onclick="saveLogo()">Upload</button>
            <div id="logoPreview"></div>
          </div>

          <div class="admin-card">
            <h3>Email Settings</h3>
            <form onsubmit="saveEmailSettings(); return false;">
              <input type="email" id="adminEmail" placeholder="Admin Email" />
              <div class="email-toggle">
                <label class="switch">
                  <input type="checkbox" id="adminEmailToggle" />
                  <span class="slider"></span>
                </label>
                <label>Send email to admin</label>
              </div>
              <div class="email-toggle">
                <label class="switch">
                  <input type="checkbox" id="customerEmailToggle" />
                  <span class="slider"></span>
                </label>
                <label>Send confirmation to customer</label>
              </div>
              <button type="submit" class="btn">Save Settings</button>
              <div id="emailSettingsMessage" class="success-message"></div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </section>

  <footer>&copy; 2025 Yes to Nails. All rights reserved.</footer>

</body>
</html>
